<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Business Math: The Formula Challenge</title>
    <style>
        :root {
            --primary: #2c3e50;
            --accent: #3498db;
            --success: #27ae60;
            --bg: #f4f7f6;
        }

        body {
            font-family: 'Segoe UI', system-ui, sans-serif;
            background-color: var(--bg);
            color: var(--primary);
            margin: 0;
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 20px;
        }

        .game-container {
            max-width: 900px;
            width: 100%;
            background: white;
            padding: 30px;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
        }

        .progress-bar {
            width: 100%;
            height: 10px;
            background: #eee;
            border-radius: 5px;
            margin-bottom: 20px;
        }

        #progress-fill {
            height: 100%;
            background: var(--accent);
            width: 0%;
            border-radius: 5px;
            transition: width 0.3s;
        }

        .scenario-box {
            background: #f8f9fa;
            padding: 25px;
            border-left: 8px solid var(--accent);
            margin-bottom: 25px;
            min-height: 100px;
            font-size: 1.25rem;
            line-height: 1.5;
        }

        .buckets-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 15px;
        }

        .bucket {
            border: 2px solid #dfe6e9;
            border-radius: 10px;
            padding: 18px;
            text-align: center;
            font-weight: 600;
            cursor: pointer;
            transition: 0.2s;
            background: white;
        }

        .bucket:hover {
            border-color: var(--accent);
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0,0,0,0.05);
        }

        .correct { background-color: #d4edda !important; border-color: #28a745 !important; color: #155724; }
        .wrong { background-color: #f8d7da !important; border-color: #dc3545 !important; color: #721c24; }

        .controls {
            margin-top: 30px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        button {
            background: var(--primary);
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 8px;
            font-size: 1rem;
            cursor: pointer;
        }

        .hidden { display: none; }
    </style>
</head>
<body>

<div class="game-container">
    <h2 style="margin-top:0">Scenario Master: Which Formula?</h2>
    <div class="progress-bar"><div id="progress-fill"></div></div>
    
    <div id="game-view">
        <div id="scenario" class="scenario-box"></div>
        <div class="buckets-grid" id="buckets"></div>
    </div>

    <div id="end-view" class="hidden" style="text-align:center">
        <h1>Excellent Work!</h1>
        <p id="final-score" style="font-size: 1.5rem"></p>
        <button onclick="resetGame()">Try Another Random Set</button>
    </div>

    <div class="controls">
        <span id="stat-text">Question 1 of 100</span>
        <span id="score-text">Score: 0</span>
    </div>
</div>

<script>
    const allScenarios = [
        // Simple Interest
        { text: "A $1,500 payday loan charges a one-time interest fee of $150 after two weeks.", formula: "Simple Interest" },
        { text: "Calculate the interest on a $3,000 personal loan at 5% annual interest for 6 months, no compounding.", formula: "Simple Interest" },
        { text: "A treasury note pays 2% flat annual interest on a $10,000 investment for 1 year.", formula: "Simple Interest" },
        // ... (Repeat logic for 100 entries)
    ];

    // Helper to generate 100 diverse scenarios programmatically for this example
    const formulaTypes = ["Simple Interest", "Compound FV", "Compound PV", "Ordinary Annuity FV", "Annuity Due FV", "Ordinary Annuity PV", "Ordinary Annuity Pmt (FV)", "Ordinary Annuity Pmt (PV)"];
    
    // I am populating the array with variations of your core requirements to reach 100
    const rawData = [
        { type: "Simple Interest", templates: ["A bridge loan for $#,### at #% for # months.", "Borrowed $#,### from a friend, paying back $### interest in one lump sum."] },
        { type: "Compound FV", templates: ["You put $#,### in a CD for # years at #% compounded monthly. What is the total?", "A $#,### investment grows at #% daily for # years. Find the future balance."] },
        { type: "Compound PV", templates: ["How much is needed today to have $#,### in # years at #% compounded quarterly?", "Find the present value of $#,### due in # years discounted at #% compounded semi-annually."] },
        { type: "Ordinary Annuity FV", templates: ["Deposit $### at the end of every month for # years at #%.", "A sinking fund requires $#,### at the end of each year for # years at #%."] },
        { type: "Annuity Due FV", templates: ["Start saving $### at the beginning of every month starting today for # years.", "Lease payments of $### are made at the start of each month into an interest-bearing account."] },
        { type: "Ordinary Annuity PV", templates: ["You want to withdraw $#,### at the end of each month for # years of retirement.", "A lottery payout pays $#,### at the end of each year for # years. What's it worth now?"] },
        { type: "Ordinary Annuity Pmt (FV)", templates: ["To save $##,### in # years, what end-of-month deposit is required at #%?", "Goal: $###,### for a house in # years. Find the required quarterly payment."] },
        { type: "Ordinary Annuity Pmt (PV)", templates: ["Monthly payment for a $##,### car loan at #% for # years.", "A mortgage of $###,### at #% for 30 years. Find the monthly payment."] }
    ];

    let gameScenarios = [];
    // Generate 100 scenarios
    for(let i=0; i<100; i++) {
        const cat = rawData[i % rawData.length];
        const temp = cat.templates[Math.floor(Math.random() * cat.templates.length)];
        const text = temp.replace(/#,###|##,###|###,###/g, Math.floor(Math.random()*10000 + 1000))
                         .replace(/###/g, Math.floor(Math.random()*500 + 50))
                         .replace(/#/g, Math.floor(Math.random()*9 + 2));
        gameScenarios.push({ text: text, formula: cat.type });
    }

    let currentIdx = 0;
    let score = 0;

    function shuffle(array) {
        for (let i = array.length - 1; i > 0; i--) {
            const j = Math.floor(Math.random() * (i + 1));
            [array[i], array[array[j]]] = [array[j], array[i]];
        }
    }

    function initGame() {
        shuffle(gameScenarios);
        currentIdx = 0;
        score = 0;
        document.getElementById('buckets').innerHTML = formulaTypes.map(t => `<div class="bucket" onclick="checkAnswer('${t}', this)">${t}</div>`).join('');
        updateUI();
    }

    function updateUI() {
        if (currentIdx < gameScenarios.length) {
            document.getElementById('scenario').innerText = gameScenarios[currentIdx].text;
            document.getElementById('stat-text').innerText = `Question ${currentIdx + 1} of ${gameScenarios.length}`;
            document.getElementById('score-text').innerText = `Score: ${score}`;
            document.getElementById('progress-fill').style.width = `${(currentIdx / gameScenarios.length) * 100}%`;
        } else {
            document.getElementById('game-view').classList.add('hidden');
            document.getElementById('end-view').classList.remove('hidden');
            document.getElementById('final-score').innerText = `You correctly identified ${score} out of ${gameScenarios.length} formulas!`;
        }
    }

    window.checkAnswer = function(choice, el) {
        if(el.classList.contains('correct') || el.classList.contains('wrong')) return;

        if (choice === gameScenarios[currentIdx].formula) {
            el.classList.add('correct');
            score++;
            setTimeout(() => {
                el.classList.remove('correct');
                currentIdx++;
                updateUI();
            }, 600);
        } else {
            el.classList.add('wrong');
            setTimeout(() => el.classList.remove('wrong'), 600);
        }
    };

    window.resetGame = function() {
        document.getElementById('game-view').classList.remove('hidden');
        document.getElementById('end-view').classList.add('hidden');
        initGame();
    };

    initGame();
</script>
</body>
</html>
